# yaziファイルマネージャーで-拡張子ごとに異なるアプリで開

## 📅 メタ情報
- **日時**: 2026/1/18 17:09:10
- **プロジェクト**: tproj
- **AIモデル**: ChatGPT
- **チャットID**: 696afb5d-b1fc-8322-af09-5c588548dcf1
- **会話番号**: 4
- **チャットURL**: https://chatgpt.com/c/696afb5d-b1fc-8322-af09-5c588548dcf1

## ❓ 質問

yaziファイルマネージャーで、拡張子ごとに異なるアプリで開く設定をスマートにしたい。

**現在の設定 (yazi.toml):**
```toml
[opener]
edit = [
  { run = 'open -a "Coda 2" "$@"', desc = "Open with Coda 2" },
]

[open]
rules = [
  { mime = "text/*", use = "edit" },
  { mime = "application/json", use = "edit" },
]
```

**やりたいこと:**
1. 拡張子ベースでアプリを切り替え（例: .md→Obsidian, .py→VSCode, .png→Preview）
2. 設定を追加しやすい構造
3. macOSの `open -a` コマンドを使う

**質問:**
1. yaziで拡張子ベースのルール設定方法（nameパターン）
2. よく使う拡張子とアプリの対応例（開発者向け）
3. 設定の整理方法（openerをグループ化するベストプラクティス）

## 💬 回答

やりたいこと、yazi的にはかなり“正攻法”でできます。ポイントは [open] の url（GlobでファイルURL＝パスにマッチ） を使うことです。拡張子ベース＝ほぼこれ。 Yazi

1) 拡張子ベースのルール（nameパターン）＝ url = "*.ext"
yazi の [open] ルールは mime だけじゃなく url でも書けます。url は Glob式で、デフォルトは大文字小文字を区別しません（区別したいなら先頭に \s）。 Yazi
例（拡張子ベース）：
tomlコードをコピーする[open]
prepend_rules = [
  { url = "*.md",  use = "obsidian" },
  { url = "*.py",  use = "vscode" },
  { url = "*.png", use = "preview" },
]

さらに重要：


上から順にマッチして、最初に当たったルールが使われる運用です（少なくとも “最初にマッチする opener を探す” 前提で設計されています）。 Yazi


既存デフォルトを残しつつ増やすなら prepend_rules / append_rules が便利です。 Yazi


append_rules に url="*" みたいなワイルドカードを置くと、デフォルトのワイルドカードよりあなたの fallback が優先されます。 Yazi



まず直したい："$@" ではなく %s を使うのがyazi流
[opener] の run は、yazi が %s などを置換する仕組みです。公式の置換パラメータは %s（選択ファイルのパス群）など。 Yazi
なので macOS の open -a もこう書くのが安定：


%s … 選択した全ファイルのパス


%s1 … 1つ目だけ（単一ファイル想定のアプリに便利）



2) よく使う拡張子→アプリ対応例（開発者向け / macOS open -a）
「役割（notes/ide/preview/pdf）」で決めると追加しやすいです。


.md/.mdx → Obsidian（ノート）


.py/.js/.ts/.tsx/.go/.rs/.c/.cpp/.h/.swift/.java/.lua/.sh/.zsh → VS Code（IDE）


.json/.yaml/.yml/.toml/.env/.ini → VS Code（設定ファイル）


.png/.jpg/.jpeg/.webp/.gif/.heic → Preview（画像）


.pdf → Preview（PDF）


.csv/.tsv → VS Code（or Numbers）


*（それ以外）→ open（macOSのデフォルト関連付け）



3) 整理のベストプラクティス：openerは「アプリ/役割」でグループ化 + ルールは prepend_rules
おすすめ構造（そのまま貼れる例）
tomlコードをコピーする# ~/.config/yazi/yazi.toml

[opener]
# まず fallback（macOSのデフォルト関連付け）
open = [
  { run = 'open %s', desc = "Open (default)", orphan = true, for = "macos" },
]

# 役割/アプリ別に “opener” を増やす
obsidian = [
  { run = 'open -a "Obsidian" %s', desc = "Open in Obsidian", orphan = true, for = "macos" },
]

vscode = [
  { run = 'open -a "Visual Studio Code" %s', desc = "Open in VS Code", orphan = true, for = "macos" },
]

preview = [
  { run = 'open -a "Preview" %s', desc = "Open in Preview", orphan = true, for = "macos" },
]

# 便利枠：Finderで場所を開く（単一ファイル前提なので %s1）
reveal = [
  { run = 'open -R %s1', desc = "Reveal in Finder", orphan = true, for = "macos" },
]

[open]
prepend_rules = [
  # Notes
  { url = "*.md",  use = "obsidian" },
  { url = "*.mdx", use = "obsidian" },

  # Code
  { url = "*.py",  use = "vscode" },
  { url = "*.js",  use = "vscode" },
  { url = "*.ts",  use = "vscode" },
  { url = "*.tsx", use = "vscode" },
  { url = "*.go",  use = "vscode" },
  { url = "*.rs",  use = "vscode" },
  { url = "*.sh",  use = "vscode" },
  { url = "*.zsh", use = "vscode" },

  # Config/data
  { url = "*.json", use = "vscode" },
  { url = "*.toml", use = "vscode" },
  { url = "*.yml",  use = "vscode" },
  { url = "*.yaml", use = "vscode" },
  { url = ".env",   use = "vscode" },
  { url = "*.env",  use = "vscode" },

  # Media
  { url = "*.png",  use = "preview" },
  { url = "*.jpg",  use = "preview" },
  { url = "*.jpeg", use = "preview" },
  { url = "*.webp", use = "preview" },
  { url = "*.heic", use = "preview" },
  { url = "*.pdf",  use = "preview" },
]

append_rules = [
  # 最後の保険：何でもmacOSデフォルトで
  { url = "*", use = "open" },
]

この構造が“追加しやすい”理由：


opener は「使うアプリの数だけ増やす」だけ（役割単位でもOK）


open ルールは「拡張子を1行足す」だけ


fallback は最後の url="*" に集約できる（append_rules のワイルドカードはデフォルトfallbackより優先される） Yazi


GUIアプリは orphan=true にして、yazi終了後もアプリ側を生かしやすい Yazi



おまけ：1つの拡張子に複数候補（通常はObsidian、必要ならVS Codeで開きたい）
use = ["A", "B"] のように複数openersを指定できます。すると open は先頭を実行し、open --interactive では候補一覧に出ます。 Yazi
例：
tomlコードをコピーする{ url = "*.md", use = ["obsidian", "vscode", "open"] }


速度・正確さの話（必要なときだけ）
mime に頼る場合、yaziは file(1) で中身からMIME推定します（未導入だと開けない等が起きる）。 Yazi
拡張子ベースで“速くて十分”なら、MIMEを拡張子DBで返す mime-ext.yazi みたいな選択肢もあります。 Yazi
ただ、今回の目的（拡張子で開き分け）は url ルールだけでほぼ完結します。

このまま貼って動かして、次は「.md は Obsidian、でも Shift+Enter` 的に“別の opener を呼びたい”」みたいな操作面まで詰めると、かなり気持ちよくなります（keymap側で“Open with”を呼ぶキーを用意するやつ）。

