# openai-codex-cliの-codex-resume

## 📅 メタ情報
- **日時**: 2026/1/17 11:12:43
- **プロジェクト**: tproj
- **AIモデル**: Gemini
- **チャットID**: 4a258148436a35a3
- **会話番号**: 1
- **チャットURL**: https://gemini.google.com/app/4a258148436a35a3

## ❓ 質問

OpenAI Codex CLIの `codex resume --last` コマンドについて教えてください。

質問：
1. `codex resume --last` は、カレントディレクトリ（作業ディレクトリ）に紐づいたセッションを再開するのか、それともグローバルな（全プロジェクト共通の）最後のセッションを再開するのか？

2. 複数のプロジェクトフォルダで同時にCodexを使っている場合、各プロジェクトの履歴を正しく分離して再開できるか？

3. 公式ドキュメントやソースコードで、セッションがどのようにディレクトリと紐づいているか確認してほしい。

コンテキスト：
- tmuxで複数プロジェクトを同時に開いている
- 各プロジェクトでcodexを起動し、履歴を引き継ぎたい
- プロジェクトAの履歴がプロジェクトBで再開されては困る

## 💬 回答

思考プロセスを表示OpenAI Codex CLI（codex コマンド）の resume 機能におけるディレクトリの紐付けについて、最新の公式ドキュメントおよび変更履歴（Changelog）に基づき回答します。結論から申し上げますと、最新バージョンの Codex CLI では、codex resume --last は「カレントディレクトリ（CWD）に紐づいた最後のセッション」を優先して再開する仕様になっています。1. codex resume --last のスコープについて回答：カレントディレクトリ（作業ディレクトリ）に紐づいたセッションを再開します。以前のバージョンでは、ディレクトリに関わらず「全プロジェクト共通の最後のセッション」を再開してしまう挙動がありましたが、コミュニティの要望（Issue #4545 等）を受け、現在の仕様では作業ディレクトリごとに履歴を分離するように修正されています。codex resume --last: 現在のディレクトリ（または Git リポジトリのルート）に関連付けられた、直近のセッションを直接起動します。codex resume --all: ディレクトリの制約を無視し、全プロジェクトを含めた全履歴からセッションを選択できます。2. 複数プロジェクトでの同時使用（tmux 等）回答：各プロジェクトの履歴を正しく分離して再開可能です。tmux で複数のプロジェクトフォルダ（プロジェクトA、プロジェクトB）を個別のウィンドウやペインで開いている場合、それぞれのディレクトリで codex resume --last を実行すれば、それぞれのディレクトリで最後に行っていた作業が個別に呼び出されます。プロジェクトAのペイン：プロジェクトAの最後の会話が再開される。プロジェクトBのペイン：プロジェクトBの最後の会話が再開される。これにより、プロジェクトAのコンテキストがプロジェクトBに混ざる（リークする）心配はありません。3. セッションとディレクトリの紐付けの仕組み公式の挙動およびメタデータの構成は以下の通りです。セッションの保存場所すべてのセッションデータは、ローカルマシンの以下のディレクトリに JSONL 形式で保存されています。
~/.codex/sessions/紐付けの仕組み（メタデータ）各セッションファイル（.jsonl）のヘッダー部分には、以下のようなメタデータが含まれています。cwd: セッションを開始した時のフルパス。workspace_root: Git 等で管理されている場合、そのプロジェクトのルートディレクトリ。codex resume コマンドが実行されると、CLI は現在のディレクトリパスを取得し、~/.codex/sessions/ 内のファイル群から cwd または workspace_root が一致するものをフィルタリングして最新のものを特定します。[!TIP]
特定のセッションを指定して再開したい場合
--last を付けずに codex resume とだけ打てば、現在のディレクトリに関連するセッションの一覧（Picker）が表示されます。万が一、自動選択が意図しないものだった場合は、こちらで確認・選択が可能です。次に行うべきこと：
現在お使いの Codex CLI のバージョンがこの仕様（CWD 尊重）に対応しているか、以下のコマンドで動作確認を行うことをお勧めします。プロジェクトAで何か発言して終了する。プロジェクトBに移動し、codex resume --last を実行して、プロジェクトAの内容が出てこないことを確認する。もし古いバージョンをお使いで挙動が安定しない場合は、npm install -g @openai/codex 等で最新版へのアップデートを試してみてください。他に具体的な設定方法や、特定のプロジェクトのみを対象にする高度なオプションについて知りたいことはありますか？
